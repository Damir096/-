Гравидограмма (gravidograma) – это один из скрининговых методов наблюдения за состоянием плода во время беременности для выявления его низкой массы.

Она позволяет регистрировать показатели клинических и лабораторных исследований. 
По гравидограмме очень удобно визуально оценивать предложенные параметры в динамике течения беременности, поскольку они указаны в виде таблицы.

Гравидограмма представляет своего рода "паспорт беременной".
В самом графике надо показывать как растет ВДМ по недельно
- Высота дна матки (ВДМ) – это расстояние от верхнего края симфиза до дна матки;

я не шибко то и разбираюсь в программировании. 
Дали задачу создать гравидограмму, что бы потом мы сохраненный пдф формат могли грузить в свою МИС в карту беременных пациентов.

Написал код. Изначально он работал. Но с разными правками(добавляю и удаляя строки код) превратилься в говно.
Потом мы захотели создать там внутри мини базу с сохранением данных пациента(ФИО и ИИН) и еженедельно обновлять график пациентов. 
Т.е график(линия) еженедельно должен двигаться вперед(вверх). Но он сейчас этого не делает).
Так же он не закрывает теперь в консоле задачу, после того как закрываем саму программу
Подскажите как довести до ума этот дерьмо код.
